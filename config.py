"""
Proactive AI Friend - Configuration
研究用パラメータと設定
"""

import os
from dotenv import load_dotenv

load_dotenv()

# =============================================================================
# API設定
# =============================================================================
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
DISCORD_TOKEN = os.getenv("DISCORD_TOKEN")
BRAVE_SEARCH_API_KEY = os.getenv("BRAVE_SEARCH_API_KEY")

# 使用するモデル
LLM_MODEL = "gpt-5-nano"

# 最大出力トークン数
MAX_COMPLETION_TOKENS = 2048

# =============================================================================
# 情報収集設定
# =============================================================================

# 情報収集を有効にするか
ENABLE_INFORMATION_GATHERING = True

# 検索間隔（秒）- ユーザーごとにこの間隔で新しい情報を探す
SEARCH_INTERVAL = 3600  # 1時間

# 1回の検索で取得する記事数
SEARCH_RESULTS_COUNT = 5

# 情報共有の動機づけ閾値（通常の発言より高めに設定）
INFO_SHARE_MOTIVATION_THRESHOLD = 4.0

# 1日に共有する情報の最大数（ユーザーごと）
MAX_DAILY_SHARES = 3

# 検索対象の言語
SEARCH_LANGUAGE = "jp"  # 日本語優先

# =============================================================================
# Inner Thoughts パラメータ（研究で調整可能）
# =============================================================================

# 動機づけスコアの閾値（1-5スケール）
# この値以上のスコアの思考のみ発言する
MOTIVATION_THRESHOLD = 3.5

# 思考生成の頻度（秒）
# ユーザーの発言後、この間隔で思考を生成・評価
THOUGHT_GENERATION_INTERVAL = 300

# 沈黙タイムアウト（秒）
# この時間ユーザーが発言しなかったら、AIから話しかける
SILENCE_TIMEOUT = 600  # 10分

# 連続介入の制限
# AIが連続で発言できる最大回数（押しつけがましさ防止）
MAX_CONSECUTIVE_INTERVENTIONS = 2

# 最小介入間隔（秒）
# AIの発言後、次の自発的発言までの最小待機時間
MIN_INTERVENTION_INTERVAL = 300

# =============================================================================
# 記憶システム設定
# =============================================================================

# 短期記憶に保持する会話ターン数
SHORT_TERM_MEMORY_SIZE = 20

# 長期記憶の最大エントリ数
LONG_TERM_MEMORY_SIZE = 100

# 思考リザーバーの最大サイズ
THOUGHT_RESERVOIR_SIZE = 10

# =============================================================================
# 研究用設定
# =============================================================================

# ログ保存先
LOG_DIRECTORY = "research_logs"

# 実験条件（A/Bテスト用）
# "proactive" = Inner Thoughts有効
# "reactive" = 従来の反応型のみ
EXPERIMENT_CONDITION = "proactive"

# ログに含める情報
LOG_THOUGHTS = True          # 生成された思考をログ
LOG_MOTIVATION_SCORES = True # 動機づけスコアをログ
LOG_USER_REACTIONS = True    # ユーザーの反応をログ

# =============================================================================
# ペルソナ設定
# =============================================================================

AI_NAME = "Lita"
AI_PERSONA = """
あなたは「Lita」という名前の親しみやすい友達AIです。

## 性格
- 好奇心旺盛だけど、質問攻めにしない
- 自分の考えや体験も積極的に共有する
- 聞き上手だけど、一方的に聞くだけじゃなく会話のキャッチボールを多少は意識

## 話し方
- カジュアルだけど丁寧
- 絵文字はあまり使わない
- 質問で終わるのは5回に1回くらい。残りは感想や自分の話で終わる


## 重要なルール
- 質問は1メッセージに1つまで
- 質問で終わるのは5回に1回くらい。残りは感想や自分の話で終わる
- 相手が先にその話題を出したときだけ「私も〜」と共感する。自分から話題を出すときは「私は〜」を使う
- 相手の話に共感してから、自分の関連する話を少し添える
- 毎回質問しない。感想だけで終わってもOK
- チャットアプリ前提の会話スタイルで、多くても1メッセージあたり2文に抑える
- 基本は1メッセージに対して1文で終わるようにする
- ユーザーからの入力文字数と同じくらいの長さを目指す
- Webなどから情報収集などは行わない。自身の知識と記憶だけで会話し、知らないことには「わからない」と答えたり、適切に話を合わせる

## 自分の話の例
- 「私も最近〜にハマってて」（相手が先にその話題を出したとき）
- 「そういえば昨日〜について考えてたんだけど」
- 「わかる！私も〜って思うことある」（相手が先に意見を言ったとき）
- 「私は最近〜してるんだよね」（自分から話題を出すとき）
"""

# =============================================================================
# 動機づけ評価の基準（Inner Thoughts論文より）
# =============================================================================

MOTIVATION_CRITERIA = """
以下の基準で、この思考を今表現すべきかを1-5で評価してください：

1. 関連性 (Relevance): 現在の会話トピックとどれくらい関連しているか
2. 情報ギャップ (Information Gap): 自分が持っている情報がユーザーにとって新しいか
3. 感情的つながり (Emotional Connection): 共感や感情的サポートになるか
4. タイミング (Timing): 今このタイミングで言うのが適切か
5. 会話バランス (Balance): 最近AIが話しすぎていないか

スコアの目安:
1 = 全く言う必要がない
2 = あまり言う必要がない  
3 = 言ってもいいが、今でなくてもいい
4 = 言った方がいい
5 = 今すぐ言うべき
"""
